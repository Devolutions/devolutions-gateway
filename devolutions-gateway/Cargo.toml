[package]
name = "devolutions-gateway"
version = "2021.1.6"
edition = "2021"
readme = "README.md"
license = "MIT/Apache-2.0"
authors = ["Devolutions Inc."]

[dependencies]

# in-house
jet-proto = { path = "../jet-proto" }
jmux-proxy = { path = "../jmux-proxy" }
sogar-core = { version = "0.3", git = "https://github.com/Devolutions/sogar", branch = "hyper-update" }
ceviche = "0.4.5"
ironrdp = { version = "0.4.1", git = "https://github.com/Devolutions/IronRDP", rev = "ca53209c84c55b41" }

# cli
clap = "2.33"
hostname = "0.3.1"

# serialization
serde = "1.0.130"
serde_derive = "1.0.130"
serde_json = "1.0.68"

# utils, misc
camino = { version = "1.0.5", features = ["serde1"] }
smol_str = "0.1.21"
tap = "1.0.1"
display_utils = "0.4.0"
byteorder = "1.4.3"
lazy_static = "1.4.0"
bytes = "1.1.0"
cfg-if = "1.0.0"
url = { version = "2.2.2", features = ["serde"] }
tempfile = "3.2.0"
indexmap = "1.7.0"
uuid = { version = "0.8.2", features = ["v4", "serde"] }
chrono = { version = "0.4.19", features = ["serde"] } # TODO: switch to `time`
parking_lot = "0.11"
anyhow = "1.0.51"
# TODO: compare performance with `ringbuf` and `sluice`
# NOTE: check if we actually still need a bip buffer for proxying though (see jetsocat)
spsc-bip-buffer = { git = "https://github.com/Devolutions/spsc-bip-buffer.git", branch = "master" }

# security, crypto…
native-tls = "0.2.8"
zeroize = "1.4.2"
rust-argon2 = "0.8.3"
picky = { version = "6.3.0", default-features = false, features = ["jose", "x509"] }
sspi = "0.3.2"
ring = "0.16.20"
# FIXME: we should use `sha-1` by RustCrypto (but we don't need this dependency if using `axum`)
sha1 = "0.6.0"
# (unrequired if using `axum`)
base64 = "0.13.0"

# logging
# TODO: consider `tracing`
slog-stdlog = "4.1.0"
slog = { version = "2.7.0", features = ["max_level_trace", "release_max_level_debug"] }
slog-term = "2.8.0"
slog-async = "2.7.0"
slog-scope = "4.4.0"
slog-envlogger = "2.2.0"
slog-scope-futures = { git = "https://github.com/Devolutions/slog-scope-futures.git" }

# async, futures…
tokio = { version = "1.13.0", features = ["signal", "net", "io-util", "time", "rt", "rt-multi-thread", "sync", "macros"] }
tokio-util = { version = "0.6.9", features = ["codec"] }
tokio-tungstenite = "0.15.0" # TODO: switch to `async-tungstenite`
tokio-rustls = { version = "0.23.1", features = ["dangerous_configuration"] }
futures = "0.3.17"

# http
hyper = "0.14.14"
reqwest = "0.11.6" # NOTE: maybe directly use hyper (we already use hyper)
http = "0.2.5"
# FIXME: update once next saphir version is published or use `axum`/`warp`
saphir = { version = "2.8", default-features = false, features = ["https", "json", "macro", "form", "operation", "file"], git = "https://github.com/CBenoit/saphir", branch = "hyper-update" }

# plugins
dlopen = "0.1.8"
dlopen_derive = "0.1.4"
# Dependencies required for PCAP support (FIXME: should we keep that built-in?)
pcap-file = "1.1.1"
packet = { git = "https://github.com/fdubois1/rust-packet.git" }

[target.'cfg(windows)'.dependencies]
winapi = { version = "0.3.9", features = ["winbase", "winuser", "winsvc", "libloaderapi", "errhandlingapi", "winerror"] }

[target.'cfg(windows)'.build-dependencies]
embed-resource = "1.6.5"

[dev-dependencies]
tokio-test = "0.4.2"
